<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Admin Dashboard</h1>

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <ul class="flashes">
              {% for message in messages %}
                <li>{{ message }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}

        <p>Total Feedback: {{ total }}</p>

        <!-- Sentiment Stats -->
    <h3>Sentiment Stats</h3>
    <div class="stats-container">
      <div class="stat-card stat-positive">
        <h4>Positive</h4>
        <p>{{ pos }} ({{ (pos / total * 100)|round(1) if total > 0 else 0 }}%)</p>
      </div>
      <div class="stat-card stat-negative">
        <h4>Negative</h4>
        <p>{{ neg }} ({{ (neg / total * 100)|round(1) if total > 0 else 0 }}%)</p>
      </div>
      <div class="stat-card stat-neutral">
        <h4>Neutral</h4>
        <p>{{ neu }} ({{ (neu / total * 100)|round(1) if total > 0 else 0 }}%)</p>
      </div>
    </div>

       <!-- Category Stats -->
        <h3>Category Stats</h3>
    <div class="stats-container">
      {% for category, count in category_stats.items() %}
        <div class="stat-card">
          <h4>{{ category }}</h4>
          <p>{{ count }}</p>
        </div>
      {% endfor %}
    </div>

      <!-- Rating Stats -->
            <h3>Rating Stats</h3>
        <div class="stats-container">
          {% for rating, count in rating_stats.items() %}
            <div class="stat-card">
              <h4>Rating {{ rating }}</h4>
              <p>{{ count }}</p>
            </div>
          {% endfor %}
        </div>

        <!-- Feedback Table -->
        <h3>Feedback Entries</h3>
        <table border="1" cellpadding="5" cellspacing="0">
          <thead>
            <tr>
              <th>ID</th>
              <th>User</th>
              <th>Email</th>
              <th>Message</th>
              <th>Category</th>
              <th>Rating</th>
              <th>Sentiment</th>
              <th>Submitted At</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for entry in entries %}
            <tr>
              <td>{{ entry[0] }}</td>
              <td>{{ entry[2] }}</td>
              <td>{{ entry[3] }}</td>
              <td>{{ entry[4] }}</td>
              <td>{{ entry[5] }}</td>
              <td>{{ entry[6] }}</td>
              <td>{{ entry[7] }}</td>
              <td>{{ entry[8] }}</td>
              <td>
                <a href="{{ url_for('edit', id=entry[0]) }}">Edit</a> |
                <a href="{{ url_for('delete', id=entry[0]) }}" onclick="return confirm('Are you sure you want to delete this feedback?');">Delete</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <p><a href="{{ url_for('logout') }}">Logout</a></p>
    </div>
</body>
</html>
